<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Mandelbrot - Maxwell Forbes</title>
        
        <meta content="Mandelbrot - Maxwell Forbes" property="title"/>
        <meta content="Mandelbrot - Maxwell Forbes" property="og:title"/>
        <meta name="twitter:title" content="Mandelbrot - Maxwell Forbes"/>

        <link href='/assets/img/fav.png' rel='shortcut icon'>
<link href='/assets/css/tachyons.min.css' rel='stylesheet' type='text/css'/>
<link href='/assets/css/style.css' rel='stylesheet' type='text/css'/>
<link href='/assets/css/syntax/prism.default.css' rel='stylesheet' type='text/css'/>



    
    <meta content='https://maxwellforbes.com/garage/mandelbrot/' property='og:url'/>
    
        <meta content='https://maxwellforbes.com/assets/garage/mandelbrot.png' property='og:image'/>
        <meta name='twitter:image' content='https://maxwellforbes.com/assets/garage/mandelbrot.png'/>
        <meta name='twitter:card' content='summary_large_image'/>
    
    <meta name='twitter:site' content='@maxforbes'/>
    
        
        <meta content=".full-width { width: calc(100vw - 10px); position: relative; left: 50%; right: 50%; margin-left: -50vw; margin-right:..." property='og:description'/>
        <meta name='twitter:description' content=".full-width { width: calc(100vw - 10px); position: relative; left: 50%; right: 50%; margin-left: -50vw; margin-right:..."/>
    
    <meta content="article" property="og:type"/>




    </head>

    <body class="lh-copy near-black pa0 f5 f4-ns sans-serif">
        

  <div class="mw7 mt3 mt4-ns mb3 center">

    <nav class="mh3 mh4-ns pv3 flex" aria-label="Main">
      <div class="w-50 tl">
        <a href="/" class="hover dim black" id="header">Maxwell Forbes</a>
      </div>
      <div class="w-50 tr">
        
          
          
            <a class="link hover-mid-gray ml3 pv1" href="/studio">
              Studio
            </a>
          
        
          
          
            <a class="link hover-mid-gray ml3 pv1" href="/research">
              Research
            </a>
          
        
      </div>
    </nav>

    <div class="mh3 mh4-ns bt b--black-80"></div>

    <main class="tl relative ph3 ph4-ns pt4 pb2 paddingOverride">
      
        <div class="mb4">
          
          
            <div class="fw600 light-silver mt1 ttu">
              
                <a href="/studio/#garage" class="light-silver hover-blue">GARAGE/</a>
              
            </div>
          

          
          <h1 class="ttu tracked f3 f2-ns mt0 lh-title cb mb2">
              Mandelbrot
          </h1>
          

        </div>
      

      
      

      <div class="markdown-body">
        <style>
    .full-width {
        width: calc(100vw - 10px);
        position: relative;
        left: 50%;
        right: 50%;
        margin-left: -50vw;
        margin-right: -50vw;
    }
</style>
<p>I finally read about the Mandelbrot set and tried implementing it.</p>
<script defer src="/assets/lib/three-r131.min.js"></script>
<script defer src="/assets/lib/p5-1.4.0.min.js"></script>
<script defer src="/assets/p5js/05-mandelbrot.js"></script>
<div id="parent" class="mt5 mb5 tc full-width">
</div>
<p class="figcaption">
Not an image. Generated live in your browser.
</p>
<p>The computation is surprisingly simple for how complex the result is.</p>
<p>I read the algorithm for computing the M-set in a book. It caused me some trouble, because it didn’t clarify two important details:</p>
<ol>
<li>
<p>How many iterations to run the procedure for. I was doing 10. Turns out something like 50 or 100 is more appropriate.</p>
</li>
<li>
<p>That coloring each pixel based on <em>which</em> iteration its length exceeds the threshold—not just a binary indicator of <em>whether</em> it ever exceeds the threshold—produces a much better image. This fading implies the areas where the set continues in further detail. It’s kind of like anti-aliasing, I think.</p>
</li>
</ol>
<p>It was fun making an ultra rudimentary complex numbers implementation.</p>
<blockquote>
<p>Random thought on this: math feels very personal, and I think it should be that way. I’m not “good” at math in the sense of people who majored in math or did math-y topics in their PhDs. But for me, enjoying math is really about working at your own pace and comfort level. Of course, you still need to push yourself into discomfort if you want to grow, but it’s like, you want to be soaking in it and feeling good with your understanding. It’s a damn shame that so many people grow up not connecting with math, and I think most people don’t end up really knowing what math is about (since they just do computations in school).</p>
</blockquote>
<p>I first drew rectangles for each sampled point (pixel), which was extremely slow (~2.6s). I checked out Daniel Shiffman’s implementation video, where he uses <code>loadPixels()</code> / <code>updatePixels()</code>. I switched to this and it is like 8–9 <em>times</em> faster (~0.3s).</p>
<p>Next, implementation with a shader, fast enough to run in real time. Click to zoom in, right-click to zoom out.</p>
<script>
    const CODE_RESOURCE_PREFIX = "/assets/p5js/"
</script>
<script defer src="/assets/p5js/06-mandelbrot-shader/06-mandelbrot-shader.js"></script>
<div id="parent2" class="mt5 mb5 tc full-width">
</div>
<p class="figcaption">
Red tent achieved by computing colors in HSL, keeping hue and saturation constant to pick the desired color, and setting the lightness to the Mandelbrot breakout iteration.
</p>

      </div>

      
      

      
      <!-- <hr /> -->
<!-- <div class="bt b--black-80 mt4"></div> -->
<div class="ba b--black-80 mt5 f6 f5-ns">
    <form style="text-align:center;" action="https://tinyletter.com/mbforbes" method="post" target="popupwindow"
        onsubmit="window.open('https://tinyletter.com/mbforbes', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
        <p class="tc b">
            Monthly project and essay digest
        </p>
        <p class="tc measure center">
            <label for="tlemail">
                I send a summary every month of my new projects and essays.
                No spam, just me, Max. Unsub whenever.
            </label>
        </p>
        <p class="mb1">
            <input type="text" style="width:200px" name="email" id="tlemail" placeholder="your email"/>
            <input type="hidden" value="1" name="embed"/><input type="submit" value="Get on the list"/>
        </p>
        <p class="mt0 f7 f6-ns">
            <!-- via -->
            <img src='/assets/img/TinyLetter_Wordmark.png' style="height: 22px;"/>
        </p>
    </form>
</div>


      
      
        <p class="tr ttu black-30 fw6 f6 f5-ns mt5 mb0">garage entry metadata</p>
<table class="mv0 collapse ba br2 b--black-10 pv2 ph3 f6 f5-ns black-50 w-100">
    <tbody id="garage-metadata">
        <tr class="striped--near-white">
            <td class="pv2 ph3 ttu fw6">
                started
            </td>
            <td class="pv2 ph3 ttu">
                21 Mar 2022
            </td>
        </tr>

        

        <tr class="striped--near-white">
            <td class="pv2 ph3 ttu fw6">
                disclaimer
            </td>
            <td class="pv2 ph3">
                This is an entry in
                
                    <a href="/garage/what-is-the-garage/" class="hover-dark-blue underline-hover">the garage</a>.
                
                It may change or disappear at any point.
            </td>
        </tr>
    </tbody>
</table>

<!-- Comments! -->
<script src="https://utteranc.es/client.js" repo="mbforbes/website-comments" issue-term="pathname" theme="github-light"
    crossorigin="anonymous" async>
    </script>

<!-- Link graph! -->
<script async>
    function addRow(name, graph, keys) {
        let links = [];
        for (let key of keys) {
            if (!(key in graph)) {
                console.warn("Skipping " + key + ", not found in link graph.")
                continue;
            }
            
            links.push(`<li><a href="${graph[key].url}" class="hover-dark-blue underline-hover">${graph[key].title}<a/></li>`);
        }
        if (links.length == 0) {
            return;
        }
        let row = document.createElement("tr");
        row.classList.add("striped--near-white");
        row.innerHTML = `
        <tr class="striped--light-gray">
            <td class="pv2 ph3 ttu fw6">
                ${name}
            </td>
            <td class="pv2 ph3 ${name}">
                <ul class="pl3 mv0">
                    ${links.join("\n")}
                </ul>
            </td>
        </tr>
        `
        document.getElementById("garage-metadata").appendChild(row);
    }

    async function renderLinks() {
        let resp = await fetch("/assets/garage/link_graph.json");
        if (!resp.ok) {
            return;
        }
        let graph = await resp.json();
        let current = "/garage/mandelbrot/";
        if (!(current in graph)) {
            return;
        }
        addRow("inbound", graph, graph[current].incoming);
        addRow("outbound", graph, graph[current].outgoing);

    }
    renderLinks();
</script>

      
    </main>
  </div>
  <footer class="mt5 f6 f5-ns mw7 center tc pt2 pb4 silver">
    <div class="mh3 mh4-ns bt b--silver mb1"></div>
    <a href="/about/" class="link silver hover-blue pv1">
      about me
    </a>
    | orig theme is
    <a href="http://github.com/muan/scribble" class="link silver hover-blue pv1">Scribble</a>
    <!-- <img src="https://maxwellforbes.com/data/img/scribble2.png" alt="scribble" class="mt4 db center" /> -->
  </footer>

  
  <script>
    // settings
    let periods = 0.5;
    let baseDelay = 1; // s
    let charDelay = 0.1; // s
    let duration = 0.70; // s
    let startW = 400; // w
    let mag = 400; // +/- w
    let refresh = 0.016667; // s

    // computed vals
    let frames = duration / refresh;

    // state
    let updaters = [];
    let frameNs = [];

    function fontWeighter(idx) {
      frameNs[idx] += 1;
      let x = (frameNs[idx] / frames) * periods * 2 * Math.PI;
      let w = Math.round(startW + mag * Math.sin(x));
      document
        .getElementById("header")
        .children[idx]
        .style
        .fontWeight = w;
      if (frameNs[idx] >= frames) {
        clearInterval(updaters[idx]);
      }
    }

    function wave() {
      // replace the string w/ elements. i write it as a string to start because i
      // couldn't get vscode's html formatter (using one for nunjucks) to not split
      // span elements each onto their own lines, which caused spaces between each
      // letter.
      let header = document.getElementById("header");
      let name = header.innerText;
      let els = [];
      for (let i = 0; i < name.length; i++) {
        let el = document.createElement("span");
        el.innerText = name[i];
        els.push(el);
      }
      header.innerText = '';
      header.append(...els);

      for (let i = 0; i < els.length; i++) {
        frameNs.push(0);
        setTimeout(() => {
          updaters.push(setInterval(fontWeighter.bind(null, i), refresh * 1000));
        }, (baseDelay + charDelay * i) * 1000);
      }
    }

    wave();
  </script>


    </body>

</html>
